<div class="editor-container {classNames}">
  {#if field && field.values}
    {#each field.values as value, index}
      <FieldValueBox 
        isTypeRange
        valueIndex={index}
        bind:value=value
        on:deleteValue="deleteValue(event.index)"
      />
    {/each}
  {/if}
  {#if isTypeRange}
    <button on:click="addRangeValue()" class="btn btn-primary add-range-value">
      Add Range Value
      <span class="glyphicon glyphicon-plus-sign"></span>
    </button>
  {/if}
</div>

<script>
  import ConfigService from "../services/config";
  import FieldValueBox from "./field-value-box.html";

  const baseRangeValue = {
    low: "",
    high: "",
    desc: "",
    id: -1,
    sortOrder: -1
  };

  const baseValue = {
    key: "",
    desc: "",
    id: -1,
    sortOrder: -1
  };

  export default {
    components: { FieldValueBox },

    oncreate() {
      let { field } = this.options.data;
      if (!(field.values && field.values.length)) {
        field.values = [];
      }
      this.set({ field });
    },

    data() {
      return {
        classNames: "",
        field: {
          values: []
        }
      };
    },
    computed: {
      isTypeRange: ({ field }) => {
        return field && field.type === "Range";
      }
    },
    methods: {
      addRangeValue() {
        let { field } = this.get();
        field.values.push(Object.assign({}, baseRangeValue));
        this.set({ field });
      },
      deleteValue(index) {
        let { field } = this.get();
        field.values.splice(index, 1);
        this.set({ field });
      }
    }
  };
</script>

<style type="text/scss" scoped>
  .add-range-value {
    display: block;
    margin: 0px auto;
  }
</style>